<entry>
  <observation classCode="OBS" moodCode="EVN">
    <templateId root="2.16.840.1.113883.10.20.24.3.62"/>
    <templateId root="2.16.840.1.113883.10.20.24.3.104"/>
    <id root="<%= entry.id %>"/>
    <code code="ASSERTION" 
          codeSystem=" 2.16.840.1.113883.5.4"
          codeSystemName="ActCode"
          displayName="Assertion"/>  
    <statusCode code="completed"/>
    <effectiveTime>
      <low value="<%= entry.start_time %>"/>
    </effectiveTime>
    <value code="102460003" 
           codeSystem="2.16.840.1.113883.6.96"
           codeSystemName="SNOMED CT"
           displayName="Decreased tolerance"/>
    <entryRelationship typeCode="CAUS" inversionInd="true">
      <procedure classCode="PROC" moodCode="EVN">
        <!--  Procedure performed template -->
        <templateId root="2.16.840.1.113883.10.20.24.3.64"/>
        <!-- Procedure Activity Procedure-->
        <templateId root="2.16.840.1.113883.10.20.22.4.14"/>
        <id root="<%= entry.id %>"/>
        <%== code_display(entry, 'preferred_code_sets' => ['LOINC', 'SNOMED-CT', 'CPT'], 'extra_content' => "sdtc:valueSet=\"#{value_set_oid}\"") %>
        <text><%= entry.description %></text>
        <statusCode code="completed"/>
        <effectiveTime>
          <low <%= value_or_null_flavor(entry.start_time) %>/>
          <high <%= value_or_null_flavor(entry.end_time) %>/>
        </effectiveTime>
      </procedure>
    </entryRelationship>
  </observation>
</entry>